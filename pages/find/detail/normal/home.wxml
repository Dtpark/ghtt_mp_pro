<view class="cu-card dynamic no-card margin-bottom" bindtap="InputBlur">
    <!-- 主题开始 -->
    <view class="cu-item shadow">
        <!-- 作者信息开始 -->
        <view class="cu-list menu-avatar">
            <view class="cu-item">
                <view class="cu-avatar round lg" style="background-image:url({{userAvatar}}{{datalist[0].authorid}});">
                </view>
                <view class="content flex-sub">
                    <view>{{datalist[0].nickname?datalist[0].nickname:datalist[0].author}}</view>
                    <view class="text-gray text-sm flex justify-between">
                        <text decode="true">{{datalist[0].dateline}}</text>
                    </view>
                </view>
            </view>
        </view>
        <!-- 作者信息结束 -->
        <!-- 标题开始 -->
        <view class="text-content text-xl text-black text-bold">
            {{thread.subject}}
        </view>
        <!-- 标题结束 -->
        <!-- 内容开始 -->
        <view class="text-content">
            <!-- <rich-text class="" nodes="{{datalist[0].message}}"></rich-text> -->
            <!-- <wxParse nodes="{{datalist[0].message}}" /> -->
            <parser html="{{datalist[0].message}}" selectable="true" tag-style="{{tagStyle}}" />
        </view>
        <!-- 内容结束 -->

        <!-- 附件开始 -->
        <view wx:if="{{datalist[0].attachments}}">
            <!-- 图片附件开始 -->
            <view wx:if="{{datalist[0].imageA.length > 0}}" class="grid flex-sub padding-lr {{(datalist[0].imageA.length > 1)?'col-3 grid-square':'col-1'}}">
                <view wx:for="{{datalist[0].imageA}}" wx:for-index="aidx" wx:for-item="image" wx:key="aid" class="bg-img {{(datalist[0].imageA.length > 1)?'':'only-img'}}" style="background-image:url({{image.newUrl}});" id="{{aidx}}" data-cellindex="0" catchtap="lookImage">
                </view>
            </view>
            <!-- 图片附件结束 -->
        </view>
        <!-- 附件结束 -->

        <!-- 点赞开始 -->
        <!-- 点赞结束 -->
        <!-- 版区开始 -->
        <view class="padding-left padding-top">
            <text class="cu-tag line-gray">{{thread.forumnames}}</text>
        </view>
        <!-- 版区结束 -->
        <!-- 底部开始 -->
        <view class="text-gray text-df flex padding">
            <view class="flex-sub text-left"><text></text>阅读 {{thread.views}}</view>
            <view class="flex-sub text-right" bindtap="collectThread"><text class="{{favorited == 1 ?'cuIcon-favorfill':'cuIcon-favor'}}"> {{collecttext}}</text></view>
        </view>
        <!-- 底部结束 -->
    </view>
    <!-- 主题结束 -->

    <!-- 回复开始 -->
    <!-- 回复导航栏开始 -->
    <view class="cu-bar bg-white margin-top-sm">
        <view class="action">
            <text class="text-black text-bold">{{thread.replies}}条评论</text>
        </view>
        <view class="action">
            <picker bindchange="PickerChange" value="{{index}}" range="{{picker}}">
                <view class="picker">
                    {{picker[index]}}
                    <text class="cuIcon-unfold"></text>
                </view>
            </picker>
        </view>
    </view>
    <!-- 回复导航栏结束 -->

    <!-- 回复列表开始 -->
    <view class="cu-item shadow solids-bottom" wx:for="{{datalist}}" wx:key="pid" wx:if="{{index != 0}}">
        <!-- 层主信息开始 -->
        <view class="cu-list menu-avatar">
            <view class="cu-item">
                <view class="cu-avatar round lg" style="background-image:url({{userAvatar}}{{datalist[index].authorid}});">
                </view>
                <view class="content flex-sub">
                    <view>{{item.nickname?item.nickname:item.username}}</view>
                    <view class="text-gray text-sm flex justify-between">
                        <text decode="true">{{item.dateline}}</text>
                    </view>
                </view>
            </view>
        </view>
        <!-- 层主信息结束 -->
        <!-- 评论内容开始 -->
        <view class="text-content">
            <!-- <rich-text class='message' nodes="{{item.message}}"></rich-text> -->
            <!-- <wxParse nodes="{{item.message}}" /> -->
            <parser html="{{item.message}}" selectable="true" tag-style="{{tagStyle}}" />
        </view>
        <!-- 评论内容结束 -->
        <!-- 附件开始 -->
        <view wx:if="{{datalist[index].attachments}}">
            <!-- 图片附件开始 -->
            <view wx:if="{{datalist[index].imageA.length > 0}}" class="grid flex-sub padding-lr {{(datalist[index].imageA.length > 1)?'col-3 grid-square':'col-1'}}">
                <view wx:for="{{datalist[index].imageA}}" wx:for-index="aidx" wx:for-item="image" wx:key="aid" class="bg-img {{(datalist[index].imageA.length > 1)?'':'only-img'}}" style="background-image:url({{image.newUrl}});" id="{{aidx}}" data-cellindex="{{index}}"
                    catchtap="lookImage">
                </view>
            </view>
            <!-- 图片附件结束 -->
        </view>
        <!-- 附件结束 -->

        <!-- 底部开始 -->
        <view class="text-gray text-df text-right padding">
            <text class="margin-lr-xs cuIcon-appreciatefill" catchtap="sendFlower" id="{{index}}" decode="true">&nbsp;{{item.postreview.support?item.postreview.support:0}}</text>
            <text class="cuIcon-messagefill margin-lr-xs" decode="true" id="{{index}}" data-pid="{{item.pid}}" catchtap="reply">&nbsp;回复</text>
        </view>
        <!-- 底部结束 -->
    </view>
    <!-- 回复列表结束 -->
    <!-- 回复结束 -->
</view>
<!-- 显示更多/已经到底 开始 -->
<view wx:if="{{hasMore}}" class="text-center text-gray margin-tb-sm">显示更多……</view>
<view wx:else class="text-center text-gray margin-tb-sm">-没有更多了-</view>
<!-- 显示更多/已经到底 结束 -->
<!-- 空白的tabbar栏高度开始 -->
<view class='cu-tabbar-height'></view>
<!-- 空白的tabbar栏高度结束 -->


<!-- 评论工具栏开始 -->
<form catchsubmit="formSubmit">
    <view class="cu-bar foot input {{InputBottom!=0?'cur':''}}" style="bottom: {{InputBottom}}px">
        <view hidden="{{!isCommend}}">
            <view class="action">
                <text class="cuIcon-emoji text-grey" catchtap="showEmoji"></text>
                <text class="cuIcon-add text-grey" catchtap="showMedia"></text>
            </view>
        </view>
        <textarea class="solid padding-left-sm" placeholder="{{placeholder}}" bindfocus="InputFocus" adjust-position="{{false}}" style="width: 60%; max-height: 200rpx; font-size: 35rpx;" auto-height="true" name="message" value="{{messageValue}}"></textarea>
        <!-- bindblur="InputBlur" focus="{{isCommend}}" -->
        <view class="text-xxl" hidden="{{isCommend}}">
            <text class=" text-grey {{thread.recommend == 1?'cuIcon-appreciatefill':'cuIcon-appreciate'}}" catchtap='sendFlower' id="0" decode="true">{{thread.recommend_add < 99 ? thread.recommend_add : '99+'}}&nbsp;</text>
            <text class="cuIcon-forward text-grey" catchtap="showModal"></text>
        </view>
        <button class="cu-btn bg-blue shadow" formType="submit" hidden="{{!isCommend}}">发送</button>
    </view>
    <!-- 多媒体面板开始 -->
    <view class="mediaPanel" hidden="{{!mediaShow}}">
        <view class="cu-bar bg-white">
            <view class="action">
                图片上传
            </view>
            <view class="action">
                {{imageList.length}}/4
            </view>
        </view>
        <view class="cu-form-group">
            <view class="grid col-4 grid-square flex-sub">
                <view class="bg-img" wx:for="{{imageList}}" wx:key="index" catchtap="ViewImage" data-url="{{imageList[index].url}}">
                    <image src='{{imageList[index].src}}' mode='aspectFill'></image>
                    <view class="cu-tag bg-red" catchtap="DelImg" data-index="{{index}}">
                        <text class="cuIcon-close"></text>
                    </view>
                </view>
                <view class="solids" bindtap="ChooseImage" wx:if="{{imageList.length<4}}">
                    <text class="cuIcon-cameraadd"></text>
                </view>
            </view>
        </view>
    </view>
    <!-- 多媒体面板结束 -->
</form>
<!-- 评论工具栏结束 -->




<!-- 底部模态框（分享）开始 -->
<view class="cu-modal bottom-modal {{isShare?'show':''}}" bindtap="hideModal">
    <view class="cu-dialog">
        <view class="padding-bottom-xs bg-gray">
            <!-- 内容开始 -->
            <view class="cu-list grid col-2 no-border">
                <view class="cu-item" catchtap="createPic">
                    <view class="cuIcon-pic text-gray">
                    </view>
                    <text>生成海报</text>
                </view>
                <view class="cu-item" catchtap="sharePost" data-items="测试">
                    <button class="shareBtn" open-type="share" data-shareInfo="{{shareInfo}}">
                        <view class="cuIcon-weixin text-gray">
                        </view>
                        <text>微信分享</text>
                    </button>
                </view>
            </view>
            <!-- 内容结束 -->
        </view>
        <view class="cu-bar bg-white justify-center ">
            <view class="action" bindtap="hideModal">取消</view>
        </view>
    </view>
</view>
<!-- 底部模态框（分享）结束 -->